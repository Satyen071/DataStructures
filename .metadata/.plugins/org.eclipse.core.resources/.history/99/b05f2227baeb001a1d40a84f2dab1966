package StackandQueue;
import java.io.*;
import java.util.*;
import java.lang.*;


import java.io.*;
import java.util.*;
import java.lang.*;

public class TestClass {
    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        PrintWriter wr = new PrintWriter(System.out);
         int Q = Integer.parseInt(br.readLine().trim());
         int[][] Queries = new int[Q][2];
         for(int i_Queries = 0; i_Queries < Q; i_Queries++)
         {
         	String[] arr_Queries = br.readLine().split(" ");
         	for(int j_Queries = 0; j_Queries < arr_Queries.length; j_Queries++)
         	{
         		Queries[i_Queries][j_Queries] = Integer.parseInt(arr_Queries[j_Queries]);
         	}
         }

         long[] out_ = solve(Q, Queries);
         System.out.print(out_[0]);
         for(int i_out_ = 0; i_out_ < out_.length; i_out_++)
         {
             if(out_[i_out_]>0)
         	System.out.println(out_[i_out_]);

         }

         wr.close();
         br.close();
    }
    static long[] solve(int Q, int[][] Queries){
       // Write your code here
long[] arr = new long[Q];
List<Long> list = new ArrayList<Long>();
        for(int i =0;i<Q;i++){
            // for(int j = 0;j<2;j++){
                if(Queries[i][0]==1){
                    list.add((long)Queries[i][1]);

                }
                 if(Queries[i][0]==3){
                    long max =0;
                    for(Long l:list){
                        if(Queries[i][1]-l>max)
                        max = Math.abs(l-Queries[i][1]);

                    }

                        if(Math.abs(max)>0)
                    arr[i] = Math.abs(max);
                    max =0;
                                    }
                if(Queries[i][0]==2){
                    list.remove(Queries[i][1]);

                }

            }
        // }
      
    return arr;
    }
}